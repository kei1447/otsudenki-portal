# 統合マスタインポートテンプレート 説明書

## ファイル
- `master_import_template.csv`

## 使用方法

### Excelで開く場合（文字化け対策）
1. Excelを起動 → **データ** タブ → **テキストまたはCSVから**
2. `master_import_template.csv` を選択
3. **元のファイル** で「65001: Unicode (UTF-8)」を選択
4. 「読み込み」をクリック

### 編集・保存
1. サンプル行（2-3行目）を参考に実データを入力
2. 保存時: **名前を付けて保存** → ファイルの種類で「**CSV UTF-8 (コンマ区切り)**」を選択
---

## カラム説明

### 取引先情報 (同じ取引先の製品は同じ値を繰り返し入力)

| カラム名 | 必須 | 説明 | 入力例 |
|---------|:----:|------|--------|
| partner_code | ○ | 取引先コード（一意） | C001 |
| partner_name | ○ | 取引先名 | 株式会社サンプル |
| address | | 住所 | 東京都千代田区1-1-1 |
| phone | | 電話番号 | 03-1234-5678 |
| corporate_number | | 法人番号（13桁） | 1234567890123 |
| closing_date | | 締め日（99=末締め） | 99 / 20 / 15 等 |
| calculation_type | | 計算方式 | （未使用） |
| partner_memo | | 取引先メモ | 備考など |

### 製品情報

| カラム名 | 必須 | 説明 | 入力例 |
|---------|:----:|------|--------|
| product_code | ○ | 品番（取引先内で一意） | ABC-001 |
| product_name | ○ | 品名 | 製品A |
| color_text | | 塗装色・カラー情報 | 黒 / マンセル N1.5 |
| material_memo | | 材質メモ | SUS304 / SPCC |
| process_memo | | 工程メモ | 焼付塗装 / 粉体塗装 |
| unit_weight | | 単位重量(g) | 150 |
| surface_area | | 表面積(㎡) | 0.05 |
| product_memo | | 製品メモ | 備考・注意事項など |
| is_discontinued | | 廃盤フラグ | TRUE / FALSE (空欄=FALSE) |

### 単価履歴 (過去4世代分 + 現在単価)

単価は**古い順**に入力します。price_1が最も古く、price_4がcurrent_priceの直前です。

| カラム名 | 必須 | 説明 | 入力例 |
|---------|:----:|------|--------|
| price_1 | | 最も古い単価（4世代前） | 100 |
| end_date_1 | | ↑の適用終了日 | 2023-03-31 |
| price_2 | | 3世代前の単価 | 110 |
| end_date_2 | | ↑の適用終了日 | 2024-03-31 |
| price_3 | | 2世代前の単価 | 120 |
| end_date_3 | | ↑の適用終了日 | 2025-03-31 |
| price_4 | | 1世代前の単価（直前） | 130 |
| end_date_4 | | ↑の適用終了日 | 2025-12-31 |
| current_price | ○ | 現在適用中の単価 | 140 |
| price_change_reason | | 単価変更理由（任意） | 2026年1月改定 |

> **入力例**: 100円 → 110円 → 120円 → 130円 → 140円(現在) と推移した場合、
> price_1=100, price_2=110, price_3=120, price_4=130, current_price=140

---

## 注意事項

1. **文字コード**: UTF-8で保存してください（Excelで「CSV UTF-8」形式）
2. **日付形式**: `YYYY-MM-DD` 形式で入力（例: 2026-01-23）
3. **空欄の扱い**: 任意項目は空欄可。単価履歴は古い順に入力不要
4. **同一取引先**: 同じ取引先の製品は、取引先情報を同じ値でコピー
5. **廃盤フラグ**: `TRUE` で廃盤扱い。空欄または `FALSE` で有効

---

## インポート後の処理

システムにインポートすると、以下のテーブルに登録されます:
- `partners` テーブル (取引先)
- `products` テーブル (製品)
- `prices` テーブル (単価履歴)
